# Медицинское приложение на Tornado и Redis

## Описание проекта

Данное приложение представляет собой REST API для управления медицинскими данными: больницами, врачами, пациентами, диагнозами и связями между врачами и пациентами.

Используется Tornado как асинхронный веб-сервер и Redis в качестве базы данных ключ-значение.

---

## Архитектура

- **Сервер:** Tornado (Python)
- **База данных:** Redis (ключ-значение)
- **Основные сущности:** Hospital, Doctor, Patient, Diagnosis, DoctorPatient (связь врач-пациент)
- **Типы запросов:**
  - GET для получения списка сущностей
  - POST для создания новых записей

Данные хранятся в Redis с использованием автоинкрементных ID для каждой сущности.

---

## Запуск проекта

### Требования

- Python 3.9+
- Redis сервер
- Необходимые Python-библиотеки:
  - tornado
  - redis
  - requests (для тестов)

### Инструкция

1. Запустите Redis сервер (по умолчанию на localhost:6379).
2. Клонируйте репозиторий или скачайте проект.
3. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
4. Запустите сервер:

    ```python3 main.py```
    
5. Сервер запущен на http://localhost:8888.
## API

### Hospital

- `GET /hospital` — получить список больниц
- `POST /hospital` — добавить больницу  
  Параметры: `name`, `address`, `phone`, `beds_number`

### Doctor

- `GET /doctor` — получить список врачей
- `POST /doctor` — добавить врача  
  Параметры: `surname`, `profession`, `hospital_ID`

### Patient

- `GET /patient` — получить список пациентов
- `POST /patient` — добавить пациента  
  Параметры: `surname`, `born_date`, `sex` ('M' или 'F'), `mpn`

### Diagnosis

- `GET /diagnosis` — получить список диагнозов
- `POST /diagnosis` — добавить диагноз  
  Параметры: `patient_ID`, `type`, `information`

### DoctorPatient (Связь врач-пациент)

- `GET /doctor-patient` — получить связи
- `POST /doctor-patient` — создать связь  
  Параметры: `doctor_ID`, `patient_ID`

---

## Тестирование

### Юнит-тесты

- Все юнит-тесты расположены в папке `tests/`.
- Запуск:
  ```bash
  python3 -m unittest discover tests
    ```
Тесты проверяют корректность API и взаимодействие с Redis.

## Нагрузочное тестирование

Для оценки производительности API использовался инструмент ApacheBench (ab).  
Тесты выполнялись по POST-запросам с параметрами из файлов `post_data/*.txt`.

### Параметры тестов

- Количество запросов (`-n`): от 10 до 50  
- Уровень конкурентности (`-c`): от 2 до 5  
- Тип содержимого: `application/x-www-form-urlencoded`  
- Целевой URL: локальный сервер `http://127.0.0.1:8888/<endpoint>`  

### Пример вызова

```bash
ab -n 50 -c 5 -p doctor_post.txt -T application/x-www-form-urlencoded http://127.0.0.1:8888/doctor
```

### Результаты тестирования

- **/patient**  
  - 10 запросов, конкурентность 2  
  - Все запросы выполнены успешно  
  - Время ответа в среднем ~5 мс  
  - RPS (Requests per second): около 380

- **/doctor**  
  - 50 запросов, конкурентность 5  
  - Почти все запросы успешны после корректировки данных  
  - Время ответа в среднем ~7 мс  
  - RPS: около 630

- **/diagnosis**  
  - 10 запросов, конкурентность 2  
  - Все запросы успешны после исправления параметров  
  - Время ответа в среднем ~6 мс  
  - RPS: около 340

### Выводы

API стабильно обрабатывает запросы с высокой скоростью и низкой задержкой при умеренной нагрузке.  
Ошибки возникали при некорректных данных или отсутствующих зависимостях (например, ссылки на несуществующие больницы или пациенты).  
Рекомендуется доработать валидацию данных на стороне клиента и сервера для повышения надёжности.


## Структура проекта

```plaintext
python3-app/
├── main.py               # Основной серверный код на Tornado
├── post_data/            # Файлы с данными для нагрузочного тестирования
├── static/               # Статические файлы (CSS, JS и др.)
├── templates/            # HTML-шаблоны для рендеринга страниц
├── tests/                # Юнит-тесты
│   └── test_endpoints.py
├── README.md             # Текущая документация
└── requirements.txt      # Зависимости Python
```



